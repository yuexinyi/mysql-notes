# 8.MySQL的复合查询

# 8.1基本查询

- 查询工资高于5000或岗位为MANAGER的雇员，同时还有满足他们的姓名字母为大写的J

  ```mysql
  select * from emp where (sal > 5000 or job = 'MANAGER') and ename like 'J%';
  ```

  

- 按照部门号升序而雇员的工资降序排序

  ```mysql
  select * from emp order by deptno,sal desc;
  ```

  

- 使用年薪进行降序排序

  年薪=工资+奖金

  ```mysql
  select ename,sal*12+ifull(comm,0)  as '年薪' from emp order by 年薪desc;
  ```

  

- 显示工资最高的员工的名字和工作岗位

  ```mysql
  select ename,job from emp where sal = (select max(sal) from emp);
  ```

  

- 显示每个部门的平均工资和最高工资

  ```mysql
  select deptno,format(avg(sal),2) ,max(sal) from emp group by deptno;
  ```

  

- 显示平均工资低于2000的部门号和它的平均工资

  ```mysql
  select deptno,avg(sal) as avg_sal from emp group by deptno having avg_sal<2000;
  ```

  

- 显示每种岗位的雇员总数，平均工资

  ```mysql
  select job,count(*),format(avg(sal),2) from emp group by job;
  ```

  

# 8.2多表查询

关系型数据库存储的主要形式是表，那么数据往往来自不同的表，所以需要多表查询。这里我们采用常用的学生表，课程表，选课表来进行多表查询

- 显示学号为10001的学生，所选课程名以及成绩

  ```mysql
  select sname,cou_name,grade from student,course,sc where sc.sno = student.sno and sc.cno = course.cno and sc.sno = '10001';
  ```

  

- 显示各个学生的姓名，所选课程号及成绩

  ```mysql
  select sname,cno,grade from student,sc where sc.sno = student.sno
  ```

  







